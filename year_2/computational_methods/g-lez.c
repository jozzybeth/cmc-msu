#include <stdio.h>
#include <math.h>
#define N 16
#define M 32
#define K 64
#define I01a 0.967237996890096 //(аналитически [0,1])
#define I12a 0.016832889701405 //(аналитически [1,2])

double f(double x) 
{
    return 1/((25*x*x + 1)*sqrt(x));
}

double integral(int a, int b, int n,double *nodes, double *weights)
{
    double x, s = 0.0;
    for (int i = 0; i < n; i++) 
    {
        x = (double) (b + a)/2 + (double) (b - a)/2 *nodes[i];
        s += weights[i] * f(x);
    }
    return s*(double) (b - a)/2;
}

int main() 
{
    double nodes_1[N] = {0.989401, 0.944575, 0.865631, 0.755404, 0.617876, 0.458017, 0.281604,
    0.095013, -0.095013, -0.281604, -0.458017, -0.617876, -0.755404, -0.865631, -0.944575, -0.989401}; // Узлы 
    double weights_1[N] = {0.027152, 0.062254, 0.095159, 0.062254, 0.149596, 0.169157, 0.182603,
    0.189451, 0.189451, 0.182603, 0.169157, 0.149596, 0.124629, 0.095159, 0.062254, 0.027152}; // Веса 
    double nodes_2[M] = {0.997264, 0.985612, 0.964762, 0.934906, 0.896321, 0.849368, 0.794484, 0.732182, 
    0.663044, 0.587716, 0.506900, 0.421351, 0.331869, 0.239287, 0.144472, 0.048308, -0.048308, -0.144472, 
    -0.239287, -0.331869, -0.421351, -0.506900, -0.587716, -0.663044, -0.732182, -0.794484, -0.849368, -0.896321, 
    -0.934906, -0.964762, -0.985612, -0.997264};
    double weights_2[M] = {0.007019, 0.016274, 0.025392, 0.034274, 0.042836, 0.050998, 0.058684, 0.065822, 0.072346,
    0.078194, 0.083312, 0.087652, 0.091174, 0.093844, 0.095639, 0.096540, 0.096540, 0.095639, 0.093844, 0.091174, 0.087652,
    0.083312, 0.078194, 0.072346, 0.065822, 0.058684, 0.050998, 0.042836, 0.034274, 0.025392, 0.016274, 0.007019};
    double nodes_3[K] = {0.99930504, 0.99634012, 0.99101337, 0.98333625, 0.97332683, 0.96100880, 0.94641137, 0.92956917, 0.91052214, 
    0.88931545, 0.86599940, 0.84062930, 0.81326532, 0.78397236, 0.75281991, 0.71988185, 0.68523631, 0.64896547, 0.61115536, 0.57189565, 
    0.53127946, 0.48940315, 0.44636602, 0.40227016, 0.35722016, 0.31132287, 0.26468716, 0.21742364, 0.16964442, 0.12146282, 0.07299312, 
    0.02435029, -0.02435029, -0.07299312, -0.12146282, -0.16964442, -0.21742364, -0.26468716, -0.31132287, -0.35722016, -0.40227016, -0.44636602, 
    -0.48940315, -0.53127946, -0.57189565, -0.61115536, -0.64896547, -0.68523631, -0.71988185, -0.75281991, -0.78397236, -0.81326532, -0.84062930, 
    -0.86599940, -0.88931545, -0.91052214, -0.92956917, -0.94641137, -0.96100880, -0.97332683, -0.98333625, -0.99101337, -0.99634012, -0.99930504};
    double weights_3[K] = {0.00178328, 0.00414703, 0.00650446, 0.00884676, 0.01116814, 0.01346305, 0.01572603, 0.01795172, 0.02013482, 0.02227017, 
    0.02435270, 0.02637747, 0.02833967, 0.03023466, 0.03205793, 0.03380516, 0.03547221, 0.03705513, 0.03855015, 0.03995374, 0.04126256, 0.04247352, 
    0.04358372, 0.04459056, 0.04549163, 0.04628480, 0.04696818, 0.04754017, 0.04799939, 0.04834476, 0.04857547, 0.04869096, 0.04869096, 0.04857547, 
    0.04834476, 0.04799939, 0.04754017, 0.04696818, 0.04628480, 0.04549163, 0.04459056, 0.04358372, 0.04247352, 0.04126256, 0.03995374, 0.03855015, 
    0.03705513, 0.03547221, 0.03380516, 0.03205793, 0.03023466, 0.02833967, 0.02637747, 0.02435270, 0.02227017, 0.02013482, 0.01795172, 0.01572603, 
    0.01346305, 0.01116814, 0.00884676, 0.00650446, 0.00414703, 0.00178328};
    double T0_16, T1_16, T0_32, T1_32, T0_64, T1_64;
    T0_16 = integral(0,1,N,nodes_1,weights_1);
    T1_16 = integral(1,2,N,nodes_1,weights_1);
    T0_32 = integral(0,1,M,nodes_2,weights_2);
    T1_32 = integral(1,2,M,nodes_2,weights_2);
    T0_64 = integral(0,1,K,nodes_3,weights_3);
    T1_64 = integral(1,2,K,nodes_3,weights_3);
    printf("n = 16\nT01 = %lf\nT12 = %lf\n", T0_16, T1_16);
    printf("delta01 = %lf\ndelta12 = %lf\n\n", fabs(I01a - T0_16), fabs(I12a - T1_16));
    printf("n = 32\nT01 = %lf\nT12 = %lf\n", T0_32, T1_32);
    printf("delta01 = %lf\ndelta12 = %lf\n\n", fabs(I01a - T0_32), 1000000*fabs(I12a - T1_32));
    printf("n = 64\nT01 = %lf\nT12 = %lf\n", T0_64, T1_64);
    printf("delta01 = %lf\ndelta12 = %lf\n", fabs(I01a - T0_64), 1000000*fabs(I12a - T1_64));
    return 0;
}






